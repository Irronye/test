GPUs on this node: 1
==> Start rank: 0
batch_size per gpu: 512
Length of dataset: 7000
Dataset name: BDD100K
==> Start training...
Input shape: torch.Size([3, 22, 22])
After conv1: torch.Size([64, 22, 22])
Traceback (most recent call last):
  File "/home/jjy8474/naturalistic-crops/DDP_byol_ccrop.py", line 313, in <module>
    main()
  File "/home/jjy8474/naturalistic-crops/DDP_byol_ccrop.py", line 205, in main
    mp.spawn(main_worker, nprocs=world_size, args=(world_size, cfg))
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 282, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 238, in start_processes
    while not context.join():
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 189, in join
    raise ProcessRaisedException(msg, error_index, failed_process.pid)
torch.multiprocessing.spawn.ProcessRaisedException: 

-- Process 0 terminated with the following error:
Traceback (most recent call last):
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/multiprocessing/spawn.py", line 76, in _wrap
    fn(i, *args)
  File "/home/jjy8474/naturalistic-crops/DDP_byol_ccrop.py", line 279, in main_worker
    train(train_loader, model, criterion, optimizer, epoch, cfg, logger, writer)
  File "/home/jjy8474/naturalistic-crops/DDP_byol_ccrop.py", line 157, in train
    p1, p2, z1, z2 = model(x1=images[0], x2=images[1])
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1636, in forward
    else self._run_ddp_forward(*inputs, **kwargs)
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 1454, in _run_ddp_forward
    return self.module(*inputs, **kwargs)  # type: ignore[index]
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jjy8474/naturalistic-crops/models/byol.py", line 60, in forward
    p1 = self.predictor(self.encoder_q(x1))  # NxC
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jjy8474/naturalistic-crops/models/resnet.py", line 146, in forward
    x = self.bn1(x)
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/modules/batchnorm.py", line 765, in forward
    return F.batch_norm(
  File "/home/jjy8474/.local/lib/python3.9/site-packages/torch/nn/functional.py", line 2512, in batch_norm
    return torch.batch_norm(
RuntimeError: running_mean should contain 22 elements not 64

